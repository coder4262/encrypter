<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Encrypter & Decrypter</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="stylesheet" href="enc.css">
  <script type="module">
    // Optional import (make sure create_element.js exists in same folder)
    import {element} from "./create_element.js";
/*
    function bin(value) {
      if (typeof value === "number" && Number.isInteger(value)) {
        return value.toString(2);
      } else if (typeof value === "string") {
        return value.split("")
          .map(char => char.charCodeAt(0).toString(2).padStart(8, "0"))
          .join(" ");
      } else {
        throw new TypeError("bin() works with integers or strings only");
      }
    }

    function unbin(value) {
      if (typeof value === "string" && /^[01 ]+$/.test(value)) {
        const parts = value.trim().split(" ");
        if (parts.length === 1) {
          return parseInt(parts[0], 2);
        } else {
          return parts.map(b => String.fromCharCode(parseInt(b, 2))).join("");
        }
      } else {
        throw new TypeError("unbin() works with binary strings only");
      }
    }

    function encrypt() {
      const plain = document.querySelector("#input").value;
      const output = btoa(plain);
      document.querySelector("#return").textContent = `Encrypted: ${output}`;
    }

    function decrypt() {
      const cipher = document.querySelector("#input").value;
      try {
        const decoded = atob(cipher);
        document.querySelector("#return").textContent = `Decrypted: ${decoded}`;
      } catch (e) {
        document.querySelector("#return").textContent = "Invalid Base64 input";
      }
    }
    window.encrypt = encrypt;
    window.decrypt = decrypt;*/
    const crypto = require('crypto');

const algorithm = 'aes-256-gcm';
const password = `b'Y*T&HEZriiBZry9cY>sl2J~6CoNTPBX9_MviAnisQvY*T&HEZriiBZry9cY>sl2J~6CoNTPBX9_MviAnisQvY*T&HEZriiBZry9cY>sl2J~6CoNTPBX9_MviAnisQvY*T&HEZriiBZry9cY>sl2J~6CoNTPBX9_MviAnisQv`;

const key = crypto.scryptSync(password, 'salt', 32);

function encrypt(text) {
  const iv = crypto.randomBytes(16);
  const cipher = crypto.createCipheriv(algorithm, key, iv);
  
  let encrypted = cipher.update(text, 'utf8', 'hex');
  encrypted += cipher.final('hex');

  const tag = cipher.getAuthTag();
  return `${iv.toString('hex')}:${encrypted}:${tag.toString('hex')}`;
}

function decrypt(encryptedText) {
  const parts = encryptedText.split(':');
  const iv = Buffer.from(parts.shift(), 'hex');
  const tag = Buffer.from(parts.pop(), 'hex');
  const encrypted = parts.join(':');
  
  const decipher = crypto.createDecipheriv(algorithm, key, iv);
  decipher.setAuthTag(tag);
  
  let decrypted = decipher.update(encrypted, 'hex', 'utf8');
  decrypted += decipher.final('utf8');
  
  return decrypted;
}
function enc(){
  const encrypted = document.querySelector("#input").value
  encrypt(encrypted)
function dec(){
  const encrypted = document.querySelector("#input").value;
  decrypt(encrypted)
}

  </script>
</head>
<body>
  <h1 style="color:rgb(99,255,2);">Encrypter & Decrypter</h1>
  <textarea id="input" placeholder="Type text to encrypt, or Base64 to decrypt"></textarea>
  <br><br>
  <button onclick="encrypt()">Encrypt</button>
  <button onclick="decrypt()">Decrypt</button>
  <p id="return"></p>
</body>
</html>

